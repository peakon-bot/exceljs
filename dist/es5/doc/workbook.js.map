{"version":3,"sources":["../../../lib/doc/workbook.js"],"names":["Worksheet","require","DefinedNames","XLSX","CSV","Workbook","module","exports","created","Date","modified","properties","_worksheets","views","media","_definedNames","prototype","xlsx","_xlsx","csv","_csv","nextId","i","length","addWorksheet","name","options","id","console","trace","tabColor","argb","theme","indexed","worksheetOptions","Object","assign","workbook","worksheet","removeWorksheetEx","removeWorksheet","getWorksheet","destroy","undefined","find","worksheets","filter","Boolean","eachSheet","iteratee","forEach","sheet","definedNames","clearThemes","_themes","addImage","image","push","type","getImage","model","creator","lastModifiedBy","lastPrinted","map","company","manager","title","subject","keywords","category","description","language","revision","contentStatus","themes","value","worksheetModel"],"mappings":"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","file":"workbook.js","sourcesContent":["/**\n * Copyright (c) 2014-2017 Guyon Roche\n * LICENCE: MIT - please refer to LICENCE file included with this module\n * or https://github.com/guyonroche/exceljs/blob/master/LICENSE\n */\n\n'use strict';\n\nvar Worksheet = require('./worksheet');\nvar DefinedNames = require('./defined-names');\nvar XLSX = require('./../xlsx/xlsx');\nvar CSV = require('./../csv/csv');\n\n// Workbook requirements\n//  Load and Save from file and stream\n//  Access/Add/Delete individual worksheets\n//  Manage String table, Hyperlink table, etc.\n//  Manage scaffolding for contained objects to write to/read from\n\nvar Workbook = module.exports = function() {\n  this.created = new Date();\n  this.modified = this.created;\n  this.properties = {};\n  this._worksheets = [];\n  this.views = [];\n  this.media = [];\n  this._definedNames = new DefinedNames();\n};\n\nWorkbook.prototype = {\n  get xlsx() {\n    return this._xlsx || (this._xlsx = new XLSX(this));\n  },\n  get csv() {\n    return this._csv || (this._csv = new CSV(this));\n  },\n  get nextId() {\n    // find the next unique spot to add worksheet\n    var i;\n    for (i = 1; i < this._worksheets.length; i++) {\n      if (!this._worksheets[i]) {\n        return i;\n      }\n    }\n    return this._worksheets.length || 1;\n  },\n  addWorksheet: function(name, options) {\n    var id = this.nextId;\n    name = name || 'sheet' + id;\n    \n    // if options is a color, call it tabColor (and signal deprecated message)\n    if (options) {\n      if (typeof options === 'string') {\n        // eslint-disable-next-line no-console\n        console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: \"rbg value\" } }');\n        options = {\n          properties: {\n            tabColor: {argb: options}\n          }\n        };\n      } else if (options.argb || options.theme || options.indexed) {\n        // eslint-disable-next-line no-console\n        console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }');\n        options = {\n          properties: {\n            tabColor: options\n          }\n        };\n      }\n    }\n\n    var worksheetOptions = Object.assign({}, options, {\n      id: id,\n      name: name,\n      workbook: this\n    });\n\n    var worksheet = new Worksheet(worksheetOptions);\n\n    this._worksheets[id] = worksheet;\n    return worksheet;\n  },\n  removeWorksheetEx: function(worksheet) {\n    delete this._worksheets[worksheet.id];\n  },\n  removeWorksheet: function(id) {\n    var worksheet = this.getWorksheet(id);\n    if (worksheet) {\n      worksheet.destroy();\n    }\n  },\n\n  getWorksheet: function(id) {\n    if (id === undefined) {\n      return this._worksheets.find(function(worksheet) { return worksheet; });\n    } else if (typeof id === 'number') {\n      return this._worksheets[id];\n    } else if (typeof id === 'string') {\n      return this._worksheets.find(function(worksheet) {\n        return worksheet && worksheet.name === id;\n      });\n    }\n    return undefined;\n  },\n\n  get worksheets() {\n    // return a clone of _worksheets\n    return this._worksheets.filter(Boolean);\n  },\n\n  eachSheet: function(iteratee) {\n    this._worksheets.forEach(function(sheet) {\n      iteratee(sheet, sheet.id);\n    });\n  },\n\n  get definedNames() {\n    return this._definedNames;\n  },\n\n  clearThemes: function() {\n    // Note: themes are not an exposed feature, meddle at your peril!\n    this._themes = undefined;\n  },\n\n  addImage: function(image) {\n    // TODO:  validation?\n    var id = this.media.length;\n    this.media.push(\n      Object.assign(\n        {},\n        image,\n        { type: 'image' }\n      )\n    );\n    return id;\n  },\n\n  getImage(id) {\n    return this.media[id];\n  },\n\n  get model() {\n    return {\n      creator: this.creator || 'Unknown',\n      lastModifiedBy: this.lastModifiedBy || 'Unknown',\n      lastPrinted: this.lastPrinted,\n      created: this.created,\n      modified: this.modified,\n      properties: this.properties,\n      worksheets: this._worksheets.filter(Boolean).map(function(worksheet) { return worksheet.model; }),\n      definedNames: this._definedNames.model,\n      views: this.views,\n      company: this.company,\n      manager: this.manager,\n      title: this.title,\n      subject: this.subject,\n      keywords: this.keywords,\n      category: this.category,\n      description: this.description,\n      language: this.language,\n      revision: this.revision,\n      contentStatus: this.contentStatus,\n      themes: this._themes,\n      media: this.media,\n    };\n  },\n  set model(value) {\n    this.creator = value.creator;\n    this.lastModifiedBy = value.lastModifiedBy;\n    this.lastPrinted = value.lastPrinted;\n    this.created = value.created;\n    this.modified = value.modified;\n    this.company = value.company;\n    this.manager = value.manager;\n    this.title = value.title;\n    this.subject = value.subject;\n    this.keywords = value.keywords;\n    this.category = value.category;\n    this.description = value.description;\n    this.language = value.language;\n    this.revision = value.revision;\n    this.contentStatus = value.contentStatus;\n\n    this.properties = value.properties;\n    this._worksheets = [];\n    value.worksheets.forEach(worksheetModel => {\n      var id = worksheetModel.id;\n      var name = worksheetModel.name;\n      var worksheet = this._worksheets[id] = new Worksheet({\n        id: id,\n        name: name,\n        workbook: this\n      });\n\n      worksheet.model = worksheetModel;\n    });\n\n    this._definedNames.model = value.definedNames;\n    this.views = value.views;\n    this._themes = value.themes;\n    this.media = value.media || [];\n  }\n};\n"]}